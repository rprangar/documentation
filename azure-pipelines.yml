# Docker
# Build a Docker image 
# https://docs.microsoft.com/azure/devops/pipelines/languages/docker

trigger:
- main

resources:
- repo: self

stages:
- stage: Build
  displayName: Build image
  jobs:  
  - job: Build
    displayName: Build
    pool:
      vmImage: 'ubuntu-latest'
    steps:
    - task: UsePythonVersion@0
      displayName: "Use Python 3.6"
      inputs:
        versionSpec: '3.6'
        architecture: 'x64'
  
    - script: pip install sphinx==1.8.1 docutils==0.14 sphinx-rtd-theme==0.4.2 sphinxcontrib-websupport==1.1.0
      displayName: "Install Python Requirements"

    - script: |
        sudo mkdir -p build publish
        sudo chmod 777 build publish
        sudo touch publish/.nojekyll
        make publish BUILDDIR=/docs/build PUBLISHDIR=/docs/publish
      displayName: "Make"
